const CONFIG={phone:"+916351802009",phoneDisplay:"6351802009",whatsappMessage:"Hi! I need electrical services. Please help.",businessHours:{start:9,end:18.5,days:[1,2,3,4,5,6]},scrollThreshold:100,animationThreshold:.1},DOM={header:document.getElementById("header"),navToggle:document.getElementById("navToggle"),navClose:document.getElementById("navClose"),navMobile:document.getElementById("navMobile"),navBackdrop:document.getElementById("navBackdrop"),navLinks:document.querySelectorAll(".nav-link, .nav-mobile-link"),backToTop:document.getElementById("backToTop"),contactForm:document.getElementById("contactForm"),callbackForm:document.getElementById("callbackForm"),quoteForm:document.getElementById("quoteForm"),modal:document.getElementById("callbackModal"),modalBackdrop:document.getElementById("modalBackdrop"),modalClose:document.getElementById("modalClose"),openModalBtns:document.querySelectorAll('[data-modal="callback"]')},Utils={debounce(e,t=10){let o;return function(...n){clearTimeout(o),o=setTimeout(()=>{clearTimeout(o),e(...n)},t)}},throttle(e,t=150){let o;return function(...n){o||(e.apply(this,n),o=!0,setTimeout(()=>o=!1,t))}},formatPhoneLink:e=>`tel:${e.replace(/\s/g,"")}`,formatWhatsAppLink:(e,t)=>`https://wa.me/${e.replace(/[^0-9]/g,"")}?text=${encodeURIComponent(t)}`,isBusinessOpen(){const e=new Date,t=e.getDay(),o=e.getHours()+e.getMinutes()/60;return CONFIG.businessHours.days.includes(t)&&o>=CONFIG.businessHours.start&&o<CONFIG.businessHours.end},isValidEmail:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),isValidPhone:e=>/^[6-9]\d{9}$/.test(e.replace(/\D/g,"")),showToast(e,t="success"){const o=document.createElement("div");o.style.cssText="position:fixed;bottom:100px;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:0.5rem;padding:1rem 1.5rem;background:#212121;color:#fff;border-radius:0.75rem;box-shadow:0 10px 25px rgba(0,0,0,0.2);z-index:9999",o.innerHTML=`<span style="color:${{success:"#10b981",error:"#ef4444",info:"#3b82f6"}[t]}">‚óè</span> ${e}`,document.body.appendChild(o),setTimeout(()=>o.remove(),3e3)}},Navigation={init(){this.bindEvents(),this.setActiveLink()},bindEvents(){DOM.navToggle&&DOM.navToggle.addEventListener("click",()=>this.openMobileMenu()),DOM.navClose&&DOM.navClose.addEventListener("click",()=>this.closeMobileMenu()),DOM.navBackdrop&&DOM.navBackdrop.addEventListener("click",()=>this.closeMobileMenu()),DOM.navLinks.forEach(e=>{e.addEventListener("click",()=>this.closeMobileMenu())}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.closeMobileMenu()}),window.addEventListener("scroll",Utils.throttle(()=>this.setActiveLink(),100))},openMobileMenu(){DOM.navMobile&&(DOM.navMobile.classList.add("active"),DOM.navBackdrop?.classList.add("active"),document.body.style.overflow="hidden")},closeMobileMenu(){DOM.navMobile&&(DOM.navMobile.classList.remove("active"),DOM.navBackdrop?.classList.remove("active"),document.body.style.overflow="")},setActiveLink(){const e=document.querySelectorAll("section[id]"),t=window.pageYOffset;e.forEach(e=>{const o=e.offsetHeight,n=e.offsetTop-150,i=e.getAttribute("id");document.querySelectorAll(`.nav-link[href*="${i}"], .nav-mobile-link[href*="${i}"]`).forEach(e=>{t>n&&t<=n+o?e.classList.add("active"):e.classList.remove("active")})})}},Header={init(){this.bindEvents(),this.checkScroll()},bindEvents(){window.addEventListener("scroll",Utils.throttle(()=>this.checkScroll(),50))},checkScroll(){DOM.header&&(window.pageYOffset>CONFIG.scrollThreshold?DOM.header.classList.add("scrolled"):DOM.header.classList.remove("scrolled"))}},BackToTop={init(){this.bindEvents(),this.checkVisibility()},bindEvents(){window.addEventListener("scroll",Utils.throttle(()=>this.checkVisibility(),100)),DOM.backToTop&&DOM.backToTop.addEventListener("click",e=>{e.preventDefault(),this.scrollToTop()})},checkVisibility(){DOM.backToTop&&(window.pageYOffset>500?DOM.backToTop.classList.add("visible"):DOM.backToTop.classList.remove("visible"))},scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}},SmoothScroll={init(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{const o=e.getAttribute("href");if("#"===o)return;t.preventDefault();const n=document.querySelector(o);if(n){const e=DOM.header?.offsetHeight||80,t=n.offsetTop-e;window.scrollTo({top:t,behavior:"smooth"})}})})}},Animation={init(){this.setupObserver(),this.observeElements()},setupObserver(){this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("visible")})},{root:null,rootMargin:"0px",threshold:CONFIG.animationThreshold})},observeElements(){document.querySelectorAll(".fade-in, .fade-in-left, .fade-in-right").forEach(e=>this.observer.observe(e))}},Modal={init(){this.bindEvents()},bindEvents(){DOM.openModalBtns.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),this.open()})}),DOM.modalClose&&DOM.modalClose.addEventListener("click",()=>this.close()),DOM.modalBackdrop&&DOM.modalBackdrop.addEventListener("click",()=>this.close()),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.close()})},open(){DOM.modal&&DOM.modalBackdrop&&(DOM.modal.classList.add("active"),DOM.modalBackdrop.classList.add("active"),document.body.style.overflow="hidden")},close(){DOM.modal&&DOM.modalBackdrop&&(DOM.modal.classList.remove("active"),DOM.modalBackdrop.classList.remove("active"),document.body.style.overflow="")}},Form={init(){this.bindEvents(),this.setupPhoneInputs()},bindEvents(){DOM.contactForm&&DOM.contactForm.addEventListener("submit",e=>this.handleSubmit(e,"contact")),DOM.callbackForm&&DOM.callbackForm.addEventListener("submit",e=>this.handleSubmit(e,"callback")),DOM.quoteForm&&DOM.quoteForm.addEventListener("submit",e=>this.handleSubmit(e,"quote"))},setupPhoneInputs(){document.querySelectorAll('input[type="tel"]').forEach(e=>{e.addEventListener("input",function(){this.value=this.value.replace(/[^0-9+\-\s]/g,"")})})},async handleSubmit(e,t){e.preventDefault();const o=e.target,n=o.querySelector('button[type="submit"]'),i=n?n.innerHTML:"";if(this.validateForm(o)){n&&(n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin"></i> Sending...');try{const e=new FormData(o),n=await fetch("https://api.web3forms.com/submit",{method:"POST",body:e});(await n.json()).success?(o.reset(),Utils.showToast("Message sent successfully! We will contact you soon.","success"),this.showSuccess(o,t)):Utils.showToast("Something went wrong. Please try again.","error")}catch(e){Utils.showToast("Failed to send message. Please try again.","error")}finally{n&&(n.disabled=!1,n.innerHTML=i)}}},validateForm(e){let t=!0;return e.querySelectorAll("input[required], textarea[required], select[required]").forEach(e=>{e.value.trim()?"email"!==e.type||Utils.isValidEmail(e.value)?"tel"!==e.type||Utils.isValidPhone(e.value)?this.clearError(e):(t=!1,this.showError(e,"Please enter a valid 10-digit phone number")):(t=!1,this.showError(e,"Please enter a valid email")):(t=!1,this.showError(e,"This field is required"))}),t},showError(e,t){e.style.borderColor="var(--error)";let o=e.parentElement.querySelector(".form-error");o||(o=document.createElement("span"),o.className="form-error",o.style.cssText="color: var(--error); font-size: 0.75rem; margin-top: 0.25rem; display: block;",e.parentElement.appendChild(o)),o.textContent=t},clearError(e){e.style.borderColor="";const t=e.parentElement.querySelector(".form-error");t&&t.remove()},showSuccess(e,t){const o=e.closest(".contact-form-wrapper"),n=o?.querySelector(".form-success");n&&(e.style.display="none",n.classList.add("active"),setTimeout(()=>{e.style.display="",n.classList.remove("active")},5e3))}},Counter={init(){this.setupObserver()},setupObserver(){const e=document.querySelectorAll("[data-counter]"),t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(this.animateCounter(e.target),t.unobserve(e.target))})},{threshold:.5});e.forEach(e=>t.observe(e))},animateCounter(e){const t=parseInt(e.dataset.counter),o=e.dataset.suffix||"",n=t/125;let i=0;const s=setInterval(()=>{i+=n,i>=t?(e.textContent=t+o,clearInterval(s)):e.textContent=Math.floor(i)+o},16)}},Gallery={init(){this.bindEvents(),this.bindFilterEvents()},bindEvents(){document.querySelectorAll(".gallery-item").forEach(e=>{e.addEventListener("click",()=>{const t=e.querySelector("img")?.src,o=e.querySelector(".gallery-item-title")?.textContent;t&&this.openLightbox(t,o)})})},bindFilterEvents(){const e=document.querySelectorAll(".filter-btn"),t=document.querySelectorAll(".gallery-item");e.length&&t.length&&e.forEach(o=>{o.addEventListener("click",()=>{e.forEach(e=>e.classList.remove("active")),o.classList.add("active");const n=o.getAttribute("data-filter");t.forEach(e=>{"all"===n||e.getAttribute("data-category")===n?e.style.display="block":e.style.display="none"})})})},openLightbox(e,t=""){let o=document.getElementById("lightbox");o||(o=document.createElement("div"),o.id="lightbox",o.style.cssText="position:fixed;inset:0;z-index:9999;display:none;background:rgba(0,0,0,0.9)",o.innerHTML='\n                <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:2rem">\n                    <button style="position:absolute;top:1rem;right:1rem;width:44px;height:44px;background:#fff;border:none;border-radius:50%;cursor:pointer;font-size:1.25rem" aria-label="Close">&times;</button>\n                    <img src="" alt="" style="max-width:90%;max-height:80vh;border-radius:0.5rem">\n                    <p style="color:#fff;margin-top:1rem"></p>\n                </div>\n            ',document.body.appendChild(o),o.querySelector("button").onclick=()=>this.closeLightbox(),o.onclick=e=>{e.target===o&&this.closeLightbox()}),o.querySelector("img").src=e,o.querySelector("p").textContent=t,o.style.display="block",document.body.style.overflow="hidden"},closeLightbox(){const e=document.getElementById("lightbox");e&&(e.style.display="none",document.body.style.overflow="")}},ServiceFilter={init(){this.bindEvents()},bindEvents(){document.querySelectorAll("[data-filter]").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.filter;this.filterServices(t),document.querySelectorAll("[data-filter]").forEach(e=>e.classList.remove("active")),e.classList.add("active")})})},filterServices(e){document.querySelectorAll(".service-card[data-category]").forEach(t=>{"all"===e||t.dataset.category===e?(t.style.display="",t.classList.add("fade-in","visible")):t.style.display="none"})}},CurrentYear={init(){const e=document.querySelectorAll("[data-year]"),t=(new Date).getFullYear();e.forEach(e=>{e.textContent=t})}},UCSearch={init(){const e=document.getElementById("heroSearch");e&&e.addEventListener("focus",()=>this.setup(),{once:!0})},setup(){const e=document.getElementById("heroSearch"),t=document.getElementById("searchSuggestions");if(!e||!t)return;const o=[{name:"House Wiring",icon:"fa-plug"},{name:"MCB Installation",icon:"fa-shield-alt"},{name:"AC Repair",icon:"fa-snowflake"},{name:"Washing Machine",icon:"fa-tshirt"}];e.addEventListener("input",e=>{const n=e.target.value.toLowerCase().trim(),i=n?o.filter(e=>e.name.toLowerCase().includes(n)):o;t.innerHTML=i.slice(0,4).map(e=>`<a href="services.html" class="uc-suggestion-item"><i class="fas ${e.icon}"></i><span>${e.name}</span></a>`).join("")})}},UCApplianceSlider={sliders:[],scrollAmount:300,init(){document.querySelectorAll(".uc-appliance-section").forEach((e,t)=>{const o=e.querySelector(".uc-appliance-track"),n=e.querySelector(".uc-slider-prev"),i=e.querySelector(".uc-slider-next");if(!o)return;const s={track:o,prevBtn:n,nextBtn:i};this.sliders.push(s),this.bindSliderEvents(s),this.updateSliderButtonStates(s)})},bindSliderEvents(e){e.prevBtn&&e.prevBtn.addEventListener("click",()=>this.scrollPrev(e)),e.nextBtn&&e.nextBtn.addEventListener("click",()=>this.scrollNext(e)),e.track.addEventListener("scroll",Utils.debounce(()=>{this.updateSliderButtonStates(e)},100))},scrollPrev(e){e.track.scrollBy({left:-this.scrollAmount,behavior:"smooth"})},scrollNext(e){e.track.scrollBy({left:this.scrollAmount,behavior:"smooth"})},updateSliderButtonStates(e){if(!e.track)return;const t=e.track.scrollLeft,o=e.track.scrollWidth-e.track.clientWidth;if(o<=0)return e.prevBtn&&(e.prevBtn.style.display="none"),void(e.nextBtn&&(e.nextBtn.style.display="none"));e.prevBtn&&(e.prevBtn.style.display="flex"),e.nextBtn&&(e.nextBtn.style.display="flex"),e.prevBtn&&(e.prevBtn.style.opacity=t<=0?"0.3":"1",e.prevBtn.style.pointerEvents=t<=0?"none":"auto"),e.nextBtn&&(e.nextBtn.style.opacity=t>=o-1?"0.3":"1",e.nextBtn.style.pointerEvents=t>=o-1?"none":"auto")}};document.addEventListener("DOMContentLoaded",()=>{Header.init(),CurrentYear.init(),UCApplianceSlider.init(),requestAnimationFrame(()=>{Navigation.init(),BackToTop.init(),SmoothScroll.init(),Form.init()}),"requestIdleCallback"in window?requestIdleCallback(()=>{Animation.init(),Modal.init(),Counter.init(),Gallery.init(),ServiceFilter.init(),UCSearch.init()},{timeout:2e3}):setTimeout(()=>{Animation.init(),Modal.init(),Counter.init(),Gallery.init(),ServiceFilter.init(),UCSearch.init()},200)});